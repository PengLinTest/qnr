(function(p){var s,t,u,r={event:{CHECK:"ztree_check"},id:{CHECK:"_check"},checkbox:{STYLE:"checkbox",DEFAULT:"chk",DISABLED:"disable",FALSE:"false",TRUE:"true",FULL:"full",PART:"part",FOCUS:"focus"},radio:{STYLE:"radio",TYPE_ALL:"all",TYPE_LEVEL:"level"}},y={check:{enable:!1,autoCheckTrigger:!1,chkStyle:r.checkbox.STYLE,nocheckInherit:!1,chkDisabledInherit:!1,radioType:r.radio.TYPE_LEVEL,chkboxType:{Y:"ps",N:"ps"}},data:{key:{checked:"checked"}},callback:{beforeCheck:null,onCheck:null}};s=function(b,
a){if(!0===a.chkDisabled)return!1;var c=f.getSetting(b.data.treeId),d=c.data.key.checked;if(!1==m.apply(c.callback.beforeCheck,[c.treeId,a],!0))return!0;a[d]=!a[d];e.checkNodeRelation(c,a);d=q(a,l.id.CHECK,c);e.setChkClass(c,d,a);e.repairParentChkClassWithSelf(c,a);c.treeObj.trigger(l.event.CHECK,[b,c.treeId,a]);return!0};t=function(b,a){if(!0===a.chkDisabled)return!1;var c=f.getSetting(b.data.treeId),d=q(a,l.id.CHECK,c);a.check_Focus=!0;e.setChkClass(c,d,a);return!0};u=function(b,a){if(!0===a.chkDisabled)return!1;
var c=f.getSetting(b.data.treeId),d=q(a,l.id.CHECK,c);a.check_Focus=!1;e.setChkClass(c,d,a);return!0};p.extend(!0,p.fn.zTree.consts,r);p.extend(!0,p.fn.zTree._z,{tools:{},view:{checkNodeRelation:function(b,a){var c,d,h,k=b.data.key.children,n=b.data.key.checked;c=l.radio;if(b.check.chkStyle==c.STYLE){var g=f.getRadioCheckedList(b);if(a[n])if(b.check.radioType==c.TYPE_ALL){for(d=g.length-1;0<=d;d--)c=g[d],c[n]=!1,g.splice(d,1),e.setChkClass(b,q(c,l.id.CHECK,b),c),c.parentTId!=a.parentTId&&e.repairParentChkClassWithSelf(b,
c);g.push(a)}else for(g=a.parentTId?a.getParentNode():f.getRoot(b),d=0,h=g[k].length;d<h;d++)c=g[k][d],c[n]&&c!=a&&(c[n]=!1,e.setChkClass(b,q(c,l.id.CHECK,b),c));else if(b.check.radioType==c.TYPE_ALL)for(d=0,h=g.length;d<h;d++)if(a==g[d]){g.splice(d,1);break}}else a[n]&&(!a[k]||0==a[k].length||-1<b.check.chkboxType.Y.indexOf("s"))&&e.setSonNodeCheckBox(b,a,!0),!a[n]&&(!a[k]||0==a[k].length||-1<b.check.chkboxType.N.indexOf("s"))&&e.setSonNodeCheckBox(b,a,!1),a[n]&&-1<b.check.chkboxType.Y.indexOf("p")&&
e.setParentNodeCheckBox(b,a,!0),!a[n]&&-1<b.check.chkboxType.N.indexOf("p")&&e.setParentNodeCheckBox(b,a,!1)},makeChkClass:function(b,a){var c=b.data.key.checked,d=l.checkbox,h=l.radio,k="",k=!0===a.chkDisabled?d.DISABLED:a.halfCheck?d.PART:b.check.chkStyle==h.STYLE?1>a.check_Child_State?d.FULL:d.PART:a[c]?2===a.check_Child_State||-1===a.check_Child_State?d.FULL:d.PART:1>a.check_Child_State?d.FULL:d.PART,c=b.check.chkStyle+"_"+(a[c]?d.TRUE:d.FALSE)+"_"+k,c=a.check_Focus&&!0!==a.chkDisabled?c+"_"+
d.FOCUS:c;return l.className.BUTTON+" "+d.DEFAULT+" "+c},repairAllChk:function(b,a){if(b.check.enable&&b.check.chkStyle===l.checkbox.STYLE)for(var c=b.data.key.checked,d=b.data.key.children,h=f.getRoot(b),k=0,n=h[d].length;k<n;k++){var g=h[d][k];!0!==g.nocheck&&!0!==g.chkDisabled&&(g[c]=a);e.setSonNodeCheckBox(b,g,a)}},repairChkClass:function(b,a){if(a&&(f.makeChkFlag(b,a),!0!==a.nocheck)){var c=q(a,l.id.CHECK,b);e.setChkClass(b,c,a)}},repairParentChkClass:function(b,a){if(a&&a.parentTId){var c=a.getParentNode();
e.repairChkClass(b,c);e.repairParentChkClass(b,c)}},repairParentChkClassWithSelf:function(b,a){if(a){var c=b.data.key.children;a[c]&&0<a[c].length?e.repairParentChkClass(b,a[c][0]):e.repairParentChkClass(b,a)}},repairSonChkDisabled:function(b,a,c,d){if(a){var h=b.data.key.children;a.chkDisabled!=c&&(a.chkDisabled=c);e.repairChkClass(b,a);if(a[h]&&d)for(var k=0,n=a[h].length;k<n;k++)e.repairSonChkDisabled(b,a[h][k],c,d)}},repairParentChkDisabled:function(b,a,c,d){a&&(a.chkDisabled!=c&&d&&(a.chkDisabled=
c),e.repairChkClass(b,a),e.repairParentChkDisabled(b,a.getParentNode(),c,d))},setChkClass:function(b,a,c){a&&(!0===c.nocheck?a.hide():a.show(),a.removeClass(),a.addClass(e.makeChkClass(b,c)))},setParentNodeCheckBox:function(b,a,c,d){var h=b.data.key.children,k=b.data.key.checked,n=q(a,l.id.CHECK,b);d||(d=a);f.makeChkFlag(b,a);!0!==a.nocheck&&!0!==a.chkDisabled&&(a[k]=c,e.setChkClass(b,n,a),b.check.autoCheckTrigger&&a!=d&&b.treeObj.trigger(l.event.CHECK,[null,b.treeId,a]));if(a.parentTId){n=!0;if(!c)for(var h=
a.getParentNode()[h],g=0,m=h.length;g<m;g++)if(!0!==h[g].nocheck&&!0!==h[g].chkDisabled&&h[g][k]||(!0===h[g].nocheck||!0===h[g].chkDisabled)&&0<h[g].check_Child_State){n=!1;break}n&&e.setParentNodeCheckBox(b,a.getParentNode(),c,d)}},setSonNodeCheckBox:function(b,a,c,d){if(a){var h=b.data.key.children,k=b.data.key.checked,n=q(a,l.id.CHECK,b);d||(d=a);var g=!1;if(a[h])for(var m=0,p=a[h].length;m<p&&!0!==a.chkDisabled;m++){var r=a[h][m];e.setSonNodeCheckBox(b,r,c,d);!0===r.chkDisabled&&(g=!0)}a!=f.getRoot(b)&&
!0!==a.chkDisabled&&(g&&!0!==a.nocheck&&f.makeChkFlag(b,a),!0!==a.nocheck&&!0!==a.chkDisabled?(a[k]=c,g)||(a.check_Child_State=a[h]&&0<a[h].length?c?2:0:-1):a.check_Child_State=-1,e.setChkClass(b,n,a),b.check.autoCheckTrigger&&a!=d&&!0!==a.nocheck&&!0!==a.chkDisabled&&b.treeObj.trigger(l.event.CHECK,[null,b.treeId,a]))}}},event:{},data:{getRadioCheckedList:function(b){for(var a=f.getRoot(b).radioCheckedList,c=0,d=a.length;c<d;c++)f.getNodeCache(b,a[c].tId)||(a.splice(c,1),c--,d--);return a},getCheckStatus:function(b,
a){if(!b.check.enable||a.nocheck||a.chkDisabled)return null;var c=b.data.key.checked;return{checked:a[c],half:a.halfCheck?a.halfCheck:b.check.chkStyle==l.radio.STYLE?2===a.check_Child_State:a[c]?-1<a.check_Child_State&&2>a.check_Child_State:0<a.check_Child_State}},getTreeCheckedNodes:function(b,a,c,d){if(!a)return[];var h=b.data.key.children,k=b.data.key.checked,e=c&&b.check.chkStyle==l.radio.STYLE&&b.check.radioType==l.radio.TYPE_ALL;d=d?d:[];for(var g=0,m=a.length;g<m&&(!0===a[g].nocheck||!0===
a[g].chkDisabled||a[g][k]!=c||(d.push(a[g]),!e))&&!(f.getTreeCheckedNodes(b,a[g][h],c,d),e&&0<d.length);g++);return d},getTreeChangeCheckedNodes:function(b,a,c){if(!a)return[];var d=b.data.key.children,h=b.data.key.checked;c=c?c:[];for(var k=0,e=a.length;k<e;k++)!0!==a[k].nocheck&&!0!==a[k].chkDisabled&&a[k][h]!=a[k].checkedOld&&c.push(a[k]),f.getTreeChangeCheckedNodes(b,a[k][d],c);return c},makeChkFlag:function(b,a){if(a){var c=b.data.key.children,d=b.data.key.checked,h=-1;if(a[c])for(var k=0,e=
a[c].length;k<e;k++){var g=a[c][k],f=-1;if(b.check.chkStyle==l.radio.STYLE)if(f=!0===g.nocheck||!0===g.chkDisabled?g.check_Child_State:!0===g.halfCheck?2:g[d]?2:0<g.check_Child_State?2:0,2==f){h=2;break}else 0==f&&(h=0);else if(b.check.chkStyle==l.checkbox.STYLE)if(f=!0===g.nocheck||!0===g.chkDisabled?g.check_Child_State:!0===g.halfCheck?1:g[d]?-1===g.check_Child_State||2===g.check_Child_State?2:1:0<g.check_Child_State?1:0,1===f){h=1;break}else if(2===f&&-1<h&&0<k&&f!==h){h=1;break}else if(2===h&&
-1<f&&2>f){h=1;break}else-1<f&&(h=f)}a.check_Child_State=h}}}});p=p.fn.zTree;var m=p._z.tools,l=p.consts,e=p._z.view,f=p._z.data,q=m.$;f.exSetting(y);f.addInitBind(function(b){b.treeObj.bind(l.event.CHECK,function(a,c,d,h){m.apply(b.callback.onCheck,[c?c:a,d,h])})});f.addInitUnBind(function(b){b.treeObj.unbind(l.event.CHECK)});f.addInitCache(function(){});f.addInitNode(function(b,a,c,d){c&&(a=b.data.key.checked,"string"==typeof c[a]&&(c[a]=m.eqs(c[a],"true")),c[a]=!!c[a],c.checkedOld=c[a],"string"==
typeof c.nocheck&&(c.nocheck=m.eqs(c.nocheck,"true")),c.nocheck=!!c.nocheck||b.check.nocheckInherit&&d&&!!d.nocheck,"string"==typeof c.chkDisabled&&(c.chkDisabled=m.eqs(c.chkDisabled,"true")),c.chkDisabled=!!c.chkDisabled||b.check.chkDisabledInherit&&d&&!!d.chkDisabled,"string"==typeof c.halfCheck&&(c.halfCheck=m.eqs(c.halfCheck,"true")),c.halfCheck=!!c.halfCheck,c.check_Child_State=-1,c.check_Focus=!1,c.getCheckStatus=function(){return f.getCheckStatus(b,c)},b.check.chkStyle==l.radio.STYLE&&b.check.radioType==
l.radio.TYPE_ALL&&c[a]&&f.getRoot(b).radioCheckedList.push(c))});f.addInitProxy(function(b){var a=b.target,c=f.getSetting(b.data.treeId),d="",h=null,e="",n=null;m.eqs(b.type,"mouseover")?c.check.enable&&(m.eqs(a.tagName,"span")&&null!==a.getAttribute("treeNode"+l.id.CHECK))&&(d=m.getNodeMainDom(a).id,e="mouseoverCheck"):m.eqs(b.type,"mouseout")?c.check.enable&&(m.eqs(a.tagName,"span")&&null!==a.getAttribute("treeNode"+l.id.CHECK))&&(d=m.getNodeMainDom(a).id,e="mouseoutCheck"):m.eqs(b.type,"click")&&
(c.check.enable&&m.eqs(a.tagName,"span")&&null!==a.getAttribute("treeNode"+l.id.CHECK))&&(d=m.getNodeMainDom(a).id,e="checkNode");if(0<d.length)switch(h=f.getNodeCache(c,d),e){case "checkNode":n=s;break;case "mouseoverCheck":n=t;break;case "mouseoutCheck":n=u}return{stop:"checkNode"===e,node:h,nodeEventType:e,nodeEventCallback:n,treeEventType:"",treeEventCallback:null}},!0);f.addInitRoot(function(b){f.getRoot(b).radioCheckedList=[]});f.addBeforeA(function(b,a,c){b.check.enable&&(f.makeChkFlag(b,a),
c.push("<span ID='",a.tId,l.id.CHECK,"' class='",e.makeChkClass(b,a),"' treeNode",l.id.CHECK,!0===a.nocheck?" style='display:none;'":"","></span>"))});f.addZTreeTools(function(b,a){a.checkNode=function(a,c,k,f){var g=b.data.key.checked;!0===a.chkDisabled||(!0!==c&&!1!==c&&(c=!a[g]),f=!!f,a[g]===c&&!k||f&&!1==m.apply(this.setting.callback.beforeCheck,[b.treeId,a],!0)||!m.uCanDo(this.setting)||!b.check.enable||!0===a.nocheck)||(a[g]=c,c=q(a,l.id.CHECK,b),(k||b.check.chkStyle===l.radio.STYLE)&&e.checkNodeRelation(b,
a),e.setChkClass(b,c,a),e.repairParentChkClassWithSelf(b,a),f&&b.treeObj.trigger(l.event.CHECK,[null,b.treeId,a]))};a.checkAllNodes=function(a){e.repairAllChk(b,!!a)};a.getCheckedNodes=function(a){var c=b.data.key.children;return f.getTreeCheckedNodes(b,f.getRoot(b)[c],!1!==a)};a.getChangeCheckedNodes=function(){var a=b.data.key.children;return f.getTreeChangeCheckedNodes(b,f.getRoot(b)[a])};a.setChkDisabled=function(a,c,f,l){c=!!c;f=!!f;e.repairSonChkDisabled(b,a,c,!!l);e.repairParentChkDisabled(b,
a.getParentNode(),c,f)};var c=a.updateNode;a.updateNode=function(d,f){c&&c.apply(a,arguments);if(d&&b.check.enable&&q(d,b).get(0)&&m.uCanDo(b)){var k=q(d,l.id.CHECK,b);!0!=f&&b.check.chkStyle!==l.radio.STYLE||e.checkNodeRelation(b,d);e.setChkClass(b,k,d);e.repairParentChkClassWithSelf(b,d)}}});var v=e.createNodes;e.createNodes=function(b,a,c,d){v&&v.apply(e,arguments);c&&e.repairParentChkClassWithSelf(b,d)};var w=e.removeNode;e.removeNode=function(b,a){var c=a.getParentNode();w&&w.apply(e,arguments);
a&&c&&(e.repairChkClass(b,c),e.repairParentChkClass(b,c))};var x=e.appendNodes;e.appendNodes=function(b,a,c,d,h,k){var l="";x&&(l=x.apply(e,arguments));d&&f.makeChkFlag(b,d);return l}})(jQuery);
