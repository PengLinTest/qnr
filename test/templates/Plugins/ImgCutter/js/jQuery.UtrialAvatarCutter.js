jQuery.UtrialAvatarCutter=function(a){var p,q,e,d,r,u,v,m=null,x=this,w=a.content,g=a.contentImgId,n=[],s=null,t=null;if(a.purviews)for(i=0,c=a.purviews.length;i<c;++i)n[n.length]=a.purviews[i];check_thums_img=function(){if(a.purviews)for(i=0,c=a.purviews.length;i<c;++i)0==$("#"+a.purviews[i].id+" img").length?$("#"+a.purviews[i].id).html("<img src='"+r+"'/>"):$("#"+a.purviews[i].id+" img").attr("src",r)};this.reload=function(b){null!=b&&""!=b&&($("#"+w).html("<img id='"+g+"' src='"+b+"'/>"),$("#"+
g).bind("load",function(){check_thums_img();x.setImgSize(500,350,this);x.init()}))};this.setImgSize=function(b,a,e){var f=new Image;f.src=e.src;var d,l=1,h=f.width,k=f.height;if(!(h<a&&k<a)){d=b/h;f=a/k;if(0==b&&0==a)l=1;else if(0==b)1>f&&(l=f);else if(0==a)1>d&&(l=d);else if(1>d||1>f)l=d<=f?d:f;1>l&&(h*=l,k*=l);150<h-k&&(k=350);150<k-h&&(h=200);e.height=k;e.width=h}};$("#"+w+" img").attr("id",g);var y=function(b){if(0==b.w||0==b.h)m.setSelect([e,d,e+q,d+p]),m.animateTo([e,d,e+q,d+p]);else for(e=
b.x,d=b.y,q=b.w,p=b.h,i=0,b=n.length;i<b;++i){var a=n[i],g=a.width/q,f=a.height/p;$("#"+a.id+" img").css({width:Math.round(g*v)+"px",height:Math.round(f*u)+"px",marginLeft:"-"+Math.round(g*e)+"px",marginTop:"-"+Math.round(f*d)+"px"})}};this.init=function(){null!=m&&m.destroy();r=$("#"+w+" img").attr("src");if(""!=r){check_thums_img();i=0;for(c=n.length;i<c;++i){var b=n[i];$("#"+b.id).css({position:"relative",overflow:"hidden",height:b.height+"px",width:b.width+"px"})}u=$("#"+g).height();v=$("#"+g).width();
s=a.selector.width;t=a.selector.height;s=Math.min(v,s);t=Math.min(u,t);e=(v-s)/2;d=(u-t)/2;m=$.Jcrop("#"+g,{aspectRatio:1,onChange:y,onSelect:y});m.animateTo([e,d,e+s,d+t])}};this.submit=function(){return{w:q,h:p,x:e,y:d,s:r,img_content_id:w}}};
